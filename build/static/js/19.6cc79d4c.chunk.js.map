{"version":3,"sources":["services/coupon/actions.js","components/Mobile/Cart/ApplyCoupon/index.js"],"names":["__webpack_require__","d","__webpack_exports__","applyCoupon","userCoupons","removeCoupon","couponApplied","_actionTypes__WEBPACK_IMPORTED_MODULE_0__","_configs__WEBPACK_IMPORTED_MODULE_1__","axios__WEBPACK_IMPORTED_MODULE_2__","axios__WEBPACK_IMPORTED_MODULE_2___default","n","token","coupon","restaurant_id","subtotal","dispatch","Axios","post","APPLY_COUPON_URL","then","response","data","type","APPLY_COUPON","payload","COUPON_ERROR","catch","error","console","log","status","USER_COUPON_URL","usercoupons","USER_COUPONS","hideMessage","coupon_error","percentage_discount","appliedAmount","Coupon","state","inputCoupon","couponFailed","couponFailedType","couponSubtotalMessage","handleApplyCoupon","coupon_id","_this","props","user","success","auth_token","restaurant_info","id","cartTotal","totalPrice","context","router","history","goBack","_this2","this","localStorage","getItem","setState","nextProps","setItem","code","removeItem","message","_this3","_this$props","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","Fragment","_Mobile_Elements_BackWithSearch__WEBPACK_IMPORTED_MODULE_9__","boxshadow","has_title","title","disable_search","homeButton","className","placeholder","length","react_content_loader__WEBPACK_IMPORTED_MODULE_10__","height","width","speed","primaryColor","secondaryColor","x","y","rx","ry","map","usercoupon","index","key","alt","src","onClick","min_subtotal","replace","Component","contextTypes","connect","items","total"],"mappings":"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","file":"static/js/19.6cc79d4c.chunk.js","sourcesContent":["import { USER_COUPONS, APPLY_COUPON, COUPON_ERROR } from \"./actionTypes\";\r\nimport { APPLY_COUPON_URL } from \"../../configs\";\r\nimport { USER_COUPON_URL } from \"../../configs\";\r\nimport Axios from \"axios\";\r\n\r\nexport const applyCoupon = (token, coupon, restaurant_id, subtotal) => (dispatch) => {\r\n\treturn Axios.post(APPLY_COUPON_URL, {\r\n\t\ttoken: token,\r\n\t\tcoupon: coupon,\r\n\t\trestaurant_id: restaurant_id,\r\n\t\tsubtotal: subtotal,\r\n\t})\r\n\t\t.then((response) => {\r\n\t\t\tconst coupon = response.data;\r\n\r\n\t\t\treturn [dispatch({ type: APPLY_COUPON, payload: coupon }), dispatch({ type: COUPON_ERROR, payload: null })];\r\n\t\t})\r\n\t\t.catch(function(error) {\r\n\t\t\tconsole.log(error);\r\n\t\t\tif (error.response.status === 401) {\r\n\t\t\t\treturn dispatch({ type: COUPON_ERROR, payload: \"NOTLOGGEDIN\" });\r\n\t\t\t}\r\n\t\t});\r\n};\r\n\r\nexport const userCoupons = (token, restaurant_id) => (dispatch) => {\r\n\tAxios.post(USER_COUPON_URL, {\r\n\t\ttoken: token,\r\n\t\trestaurant_id: restaurant_id,\r\n\t})\r\n\t.then((response) => {\r\n\t\tconst usercoupons = response.data;\r\n\t\treturn dispatch({ type: USER_COUPONS, payload: usercoupons });\r\n\t})\r\n\t.catch(function(error) {\r\n\t\tconsole.log(error);\r\n\t});\r\n};\r\n\r\nexport const removeCoupon = () => (dispatch) => {\r\n\tconsole.log(\"Triggred Coupon Removed\");\r\n\r\n\tconst coupon = { hideMessage: true, coupon_error: \"\" };\r\n\treturn dispatch({ type: APPLY_COUPON, payload: coupon });\r\n};\r\n\r\nexport const couponApplied = (coupon, percentage_discount) => (dispatch) => {\r\n\tcoupon.appliedAmount = percentage_discount;\r\n\treturn dispatch({ type: APPLY_COUPON, payload: coupon });\r\n};\r\n","import React, { Component } from \"react\";\r\n\r\nimport Ink from \"react-ink\";\r\nimport { userCoupons, applyCoupon } from \"../../../../services/coupon/actions\";\r\nimport { connect } from \"react-redux\";\r\nimport BackWithSearch from \"../../../Mobile/Elements/BackWithSearch\";\r\nimport ContentLoader from \"react-content-loader\";\r\nimport { Redirect } from \"react-router\";\r\n\r\nclass Coupon extends Component {\r\n\r\n\tstatic contextTypes = {\r\n\t\trouter: () => null,\r\n\t};\r\n\t\r\n\tstate = {\r\n\t\tinputCoupon: \"\",\r\n\t\tcouponFailed: false,\r\n\t\tcouponFailedType: \"\",\r\n\t\tcouponSubtotalMessage: \"\",\r\n\t};\r\n\r\n\tcomponentDidMount() {\r\n\t\tconst { user } = this.props;\r\n\t\tconst token = user.success ? this.props.user.data.auth_token : null;\r\n\t\tthis.props.userCoupons(token, this.props.restaurant_info.id);\r\n\r\n\t\t// automatically apply coupon if already exists in localstorage\r\n\t\tif (localStorage.getItem(\"appliedCoupon\")) {\r\n\t\t\tthis.setState({ inputCoupon: localStorage.getItem(\"appliedCoupon\") }, () => {\r\n\t\t\t\tconst { user } = this.props;\r\n\t\t\t\tconst token = user.success ? this.props.user.data.auth_token : null;\r\n\t\t\t\tthis.props.applyCoupon(\r\n\t\t\t\t\ttoken,\r\n\t\t\t\t\tlocalStorage.getItem(\"appliedCoupon\"),\r\n\t\t\t\t\tthis.props.restaurant_info.id,\r\n\t\t\t\t\tthis.props.cartTotal.totalPrice\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t}\r\n\t\t// this.context.router.history.goBack();\r\n\t}\r\n\t\r\n\tcomponentWillReceiveProps(nextProps) {\r\n\t\tconst { coupon } = this.props;\r\n\t\t//check if props changed after calling the server\r\n\t\tif (coupon !== nextProps.coupon) {\r\n\t\t\t//if nextProps.coupon is successful then\r\n\t\t\tif (nextProps.coupon.success) {\r\n\t\t\t\t// console.log(\"SUCCESS COUPON\");\r\n\t\t\t\tlocalStorage.setItem(\"appliedCoupon\", nextProps.coupon.code);\r\n\t\t\t\tthis.setState({ couponFailed: false });\r\n\t\t\t} else {\r\n\t\t\t\t// console.log(\"COUPON Removed\");\r\n\t\t\t\t// coupon is invalid\r\n\t\t\t\t// console.log(\"FAILED COUPON\");\r\n\t\t\t\tlocalStorage.removeItem(\"appliedCoupon\");\r\n\t\t\t\tlocalStorage.removeItem(\"couponAppliedAmount\");\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tcouponFailed: !nextProps.coupon.hideMessage,\r\n\t\t\t\t\tcouponFailedType: nextProps.coupon.type,\r\n\t\t\t\t\tcouponSubtotalMessage: nextProps.coupon.message,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\thandleApplyCoupon = (coupon_id) => {\r\n\t\tconst { user } = this.props;\r\n\t\tconst token = user.success ? this.props.user.data.auth_token : null;\r\n\t\tthis.props.applyCoupon(token, coupon_id, this.props.restaurant_info.id, this.props.cartTotal.totalPrice).then((response) => {\r\n\t\t\tconsole.log(response);\r\n\t\t\tthis.context.router.history.goBack();\r\n\t\t\t// if (response && response.success) {\r\n\t\t\t// \t//successfully saved\r\n\t\t\t// \tthis.context.router.history.goBack();\r\n\t\t\t// }\r\n\t\t});\r\n\t};\r\n\r\n\tcomponentWillUnmount() {\r\n\t\t// this.props.coupon.code = undefined;\r\n\t\t// localStorage.removeItem(\"appliedCoupon\");\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { usercoupons, coupon, user } = this.props;\r\n\t\t// console.log(this.props.cartTotal.totalPrice);\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<BackWithSearch\r\n\t\t\t\t\tboxshadow={true}\r\n\t\t\t\t\thas_title={true}\r\n\t\t\t\t\ttitle={\"APPLY COUPON\"}\r\n\t\t\t\t\tdisable_search={true}\r\n\t\t\t\t\thomeButton={false}\r\n\t\t\t\t/>\r\n\t\t\t\t<div className=\"coupon-header\">\r\n\t\t\t\t\t<div className=\"_3Qhg8\">\r\n\t\t\t\t\t\t<div className=\"_1ZSQj\">\r\n\t\t\t\t\t\t\t<div className=\"_3sRAt\"><input className=\"_3cdyb\" type=\"text\" placeholder=\"Enter Coupon Code\" /></div>\r\n\t\t\t\t\t\t\t<div className=\"_2uBSr _3hylU\">Apply</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<h2 className=\"_3K0qi\">AVAILABLE COUPONS</h2>\r\n\t\t\t\t</div>\r\n\t\t\t\t{this.props.usercoupons.length === 0 ? (\r\n\t\t\t\t\t<ContentLoader\r\n\t\t\t\t\t\theight={378}\r\n\t\t\t\t\t\twidth={400}\r\n\t\t\t\t\t\tspeed={1.2}\r\n\t\t\t\t\t\tprimaryColor=\"#f3f3f3\"\r\n\t\t\t\t\t\tsecondaryColor=\"#ecebeb\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<rect x=\"20\" y=\"20\" rx=\"4\" ry=\"4\" width=\"80\" height=\"78\" />\r\n\t\t\t\t\t\t<rect x=\"144\" y=\"30\" rx=\"0\" ry=\"0\" width=\"115\" height=\"18\" />\r\n\t\t\t\t\t\t<rect x=\"144\" y=\"60\" rx=\"0\" ry=\"0\" width=\"165\" height=\"16\" />\r\n\r\n\t\t\t\t\t\t<rect x=\"20\" y=\"145\" rx=\"4\" ry=\"4\" width=\"80\" height=\"78\" />\r\n\t\t\t\t\t\t<rect x=\"144\" y=\"155\" rx=\"0\" ry=\"0\" width=\"115\" height=\"18\" />\r\n\t\t\t\t\t\t<rect x=\"144\" y=\"185\" rx=\"0\" ry=\"0\" width=\"165\" height=\"16\" />\r\n\r\n\t\t\t\t\t\t<rect x=\"20\" y=\"270\" rx=\"4\" ry=\"4\" width=\"80\" height=\"78\" />\r\n\t\t\t\t\t\t<rect x=\"144\" y=\"280\" rx=\"0\" ry=\"0\" width=\"115\" height=\"18\" />\r\n\t\t\t\t\t\t<rect x=\"144\" y=\"310\" rx=\"0\" ry=\"0\" width=\"165\" height=\"16\" />\r\n\t\t\t\t\t</ContentLoader>\r\n\t\t\t\t) : (\r\n\t\t\t\t\tthis.props.usercoupons.map((usercoupon, index) => (\r\n\t\t\t\t\t\t<React.Fragment key={usercoupon.id}>\r\n\t\t\t\t\t\t\t<div className=\"rpOr6 HmMYg\">\r\n\t\t\t\t\t\t\t<div className=\"vJcVv\">\r\n\t\t\t\t\t\t\t\t<div className=\"Crzsi\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"_2BAr3 _3-8tC\"><img alt=\"\" className=\"_2yQPs _3SKwK\" height=\"20\" width=\"20\" src=\"https://res.cloudinary.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,w_40,h_40/rng/md/ads/production/jcuiipzv1wspesayzyok\"/><span className=\"_1rOlC\">{usercoupon.code}<span className=\"QQ9Qf\"></span><span className=\"_1sFBB\"></span></span></div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<span className=\"J7O-y\" onClick={() => this.handleApplyCoupon(usercoupon.code)}>APPLY\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"_1lsNa\">Get 30% off</div>\r\n\t\t\t\t\t\t\t<div className=\"_1xami\">Use code {usercoupon.code} &amp; get 30% off on orders above ₹{usercoupon.min_subtotal.replace('.00', '')}. Maximum discount: ₹75.</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t))\r\n\t\t\t\t)}\r\n\t\t\t</React.Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n\tcoupon: state.coupon.coupon,\r\n\tusercoupons: state.coupon.usercoupons,\r\n\trestaurant_info: state.items.restaurant_info,\r\n\tuser: state.user.user,\r\n\tcartTotal: state.total.data,\r\n});\r\n\r\nexport default connect(\r\n\tmapStateToProps,\r\n\t{ userCoupons, applyCoupon }\r\n)(Coupon);\r\n"],"sourceRoot":""}